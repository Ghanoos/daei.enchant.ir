<!DOCTYPE html>
<html dir="rtl" lang="fa">
  
  <head><meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="author" content="مهدی صادقی" />
<meta name="copyright" content="Commons Attribution 4.0 International" />
<meta name="robot" content="" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="description" content="سکوی انتشار مطالبی در مورد دانش تولید نرم‌افزار و ایده‌ها و علایق شخصی‌ام." />

<link rel="canonical" href="https://mehdix.ir/publishing-with-jekyll.html" />
<link rel="icon" href="https://mehdix.ir/assets/img/me.png" />
<link rel="stylesheet" href="https://mehdix.ir/assets/css/main.css" />
<link rel="stylesheet" href="https://mehdix.ir/assets/fonts/fontawesomev5.0.2.css" />
<meta name="keywords" content='ssl,امنیت,وب' /><title>طریقه نصب گواهینامه SSL روی سرور شخصی - مهدی صادقی</title><!-- Begin Jekyll SEO tag v2.4.0 -->
<title>طریقه نصب گواهینامه SSL روی سرور شخصی | مهدی صادقی</title>
<meta name="generator" content="Jekyll v3.7.2" />
<meta property="og:title" content="طریقه نصب گواهینامه SSL روی سرور شخصی" />
<meta name="author" content="مهدی صادقی" />
<meta property="og:locale" content="fa_IR" />
<meta name="description" content="امنیت رو باید جدی گرفت. هرچند من متخصص امنیت نیستم ولی برای درک اهمیت استفاده از پروتکل‌های امن نیازی به متخصص بودن نیست. اینکه اسم کاربری و کلمه عبور و سایر داده‌های حساس باید به شکل رمزگذاری شده ارسال بشوند دیگر چیزی بدیهی به نظر می‌رسد." />
<meta property="og:description" content="امنیت رو باید جدی گرفت. هرچند من متخصص امنیت نیستم ولی برای درک اهمیت استفاده از پروتکل‌های امن نیازی به متخصص بودن نیست. اینکه اسم کاربری و کلمه عبور و سایر داده‌های حساس باید به شکل رمزگذاری شده ارسال بشوند دیگر چیزی بدیهی به نظر می‌رسد." />
<link rel="canonical" href="https://mehdix.ir/installing-ssl-certificate.html" />
<meta property="og:url" content="https://mehdix.ir/installing-ssl-certificate.html" />
<meta property="og:site_name" content="مهدی صادقی" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2014-12-18T00:00:00+01:00" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@msadeghii" />
<meta name="twitter:creator" content="@مهدی صادقی" />
<script type="application/ld+json">
{"@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://mehdix.ir/installing-ssl-certificate.html"},"url":"https://mehdix.ir/installing-ssl-certificate.html","author":{"@type":"Person","name":"مهدی صادقی"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://mehdix.ir/assets/img/me.png"},"name":"مهدی صادقی"},"description":"امنیت رو باید جدی گرفت. هرچند من متخصص امنیت نیستم ولی برای درک اهمیت استفاده از پروتکل‌های امن نیازی به متخصص بودن نیست. اینکه اسم کاربری و کلمه عبور و سایر داده‌های حساس باید به شکل رمزگذاری شده ارسال بشوند دیگر چیزی بدیهی به نظر می‌رسد.","headline":"طریقه نصب گواهینامه SSL روی سرور شخصی","dateModified":"2014-12-18T00:00:00+01:00","datePublished":"2014-12-18T00:00:00+01:00","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  </head>

  <body><header>
  <div class="wrapper">
    <a class="site-title" href="https://mehdix.ir/">مهدی صادقی</a>
    <small id="motto"> در مورد نرم‌افزار و ایده‌هایم </small>
  </div>
</header>
<main>
      <div class="wrapper">

<article class="post-content">

  <div class="post-header">
    <h1 class="post-title">طریقه نصب گواهینامه SSL روی سرور شخصی</h1>
    <p>
      <i class="fas fa-calendar"></i>
      پنج‌شنبه ۲۷ آذر ۱۳۹۳<br>
      
      <i class="fas fa-stopwatch"></i>
      ۲ دقیقه مطالعه
    </p>
  </div>

  <p>امنیت رو باید جدی گرفت. هرچند من متخصص امنیت نیستم ولی برای درک اهمیت استفاده از پروتکل‌های امن نیازی به متخصص بودن نیست. اینکه اسم کاربری و کلمه عبور و سایر داده‌های حساس باید به شکل رمزگذاری شده ارسال بشوند دیگر چیزی بدیهی به نظر می‌رسد.</p>

<p>بنابراین من تصمیم گرفتم به قول معروف برای «فال و تماشا» یک گواهینامه SSL برای دامنه <a href="http://mehdix.org">mehdix.org</a> تهیه و فعال کنم. دستورات این راهنما رو من از سایت ‎<a href="https://aralbalkan.com/scribbles/setting-up-ssl-with-nginx-using-a-namecheap-essentialssl-wildcard-certificate-on-digitalocean/">آرال بالکان</a> برداشتم.</p>

<h2 id="بسته-آموزشی-گیتهاب">بسته آموزشی گیت‌هاب</h2>
<p>من در این راهنما از یک سرور شخصی روی <a href="https://digitalocean.com">DigitalOcean</a> و همچنین یک گواهینامه SSL از namecheap.com استفاده کردم. من برای تهیه اینها پولی پرداخت نکردم، بلکه اینها رو از طریق <a href="https://education.github.com">بسته آموزشی گیت‌هاب</a> بدست آوردم. برای اینکار فقط کافیه یک ایمیل دانشگاهی داشته باشید و در پروژه‌ی بالا ثبت نام کنید و به سرویس‌های مختلفی برای تقریبا یک سال به رایگان دسترسی پیدا کنید.</p>

<p class="center"><img src="assets/pimg/gheducationpack.png" alt="image" title="Github Education Pack" /></p>

<h2 id="خرید-گواهینامه">خرید گواهینامه</h2>
<p>من ابتدا یک گواهینامه <em>Positive SSL</em> از سایت <em>namecheap.com</em> برای دامنه‌ام خریداری کردم. بدون خرید گواهینامه هم می‌شه روی سرور شخصی اتصال <em>https</em> داشت اما توسط مرورگر تایید نمی‌شه و پیام هشدار دریافت می‌کنید. در حالی که گواهینامه بالا بعد از نصب به رنگ سبز در نوار آدرس کروم نمایش داده می‌شه. گواهینامه‌ای که من خریدم فقط برای یک دامنه تنها اعتبار داره و شامل زیردامنه‌ها نخواهد بود. برای اینکار باید از یک گواهینامه گرانتر بنام <em>Wildcard SSL Certificate</em> استفاده کرد.</p>

<h2 id="تولید-کلیدهای-اولیه">تولید کلیدهای اولیه</h2>
<p>اول به ماشین مورد نظر <em>ssh</em> می‌کنیم و دستور زیر رو جهت تولید یک کلید خصوصی وارد می‌کنیم:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">openssl genrsa 2048 <span class="o">&gt;</span> key.pem</code></pre></figure>

<p>فراموش نکنید که کلیدها رو به ماشین خودتون <em>scp</em> کنید. حالا یک <strong>درخواست گواهینامه</strong> تولید می‌کنیم:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">openssl req <span class="nt">-new</span> <span class="nt">-key</span> key.pem <span class="nt">-out</span> csr.pem</code></pre></figure>

<p>به سوالات پرسیده شده جواب بدین و برای گزینه <em>Common Name</em> اسم دامنه خودتون را با پسوندش وارد کنید (بدون پیشوند). لزومی به وارد <em>Challenge Password</em> نیست.</p>

<p>در هنگام خرید گواهینامه در سایت صادرکننده از ما درخواست <em>csr</em> خواهد شد که مخفف کلمه <strong>Certificate Signing Request</strong> است. در آنجا جهت فعالسازی گواهینامه و انجام کامل عملیات صدور باید محتویات فایل <em>csr.pem</em> را کپی کنیم. بعد از این مرحله و تکمیل مراحل صدور یک فایل زیپ شده حاوی فایل‌های زیر برای ما ایمیل خواهد شد:</p>

<ul>
  <li>yourdomain_extension.crt</li>
  <li>COMODORSADomainValidationSecureServerCA.crt</li>
  <li>COMODORSAAddTrustCA.crt</li>
  <li>AddTrustExternalCARoot.crt</li>
</ul>

<p>حال باید از روی اینها ما یک <em>Certificate Bundle</em> بسازیم:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">cat </span>STAR_yourdomain_ext.crt COMODORSADomainValidationSecureServerCA.crt COMODORSAAddTrustCA.crt AddTrustExternalCARoot.crt <span class="o">&gt;</span> bundle.cer</code></pre></figure>

<h2 id="کپی-فایلهای-گواهینامه">کپی فایل‌های گواهینامه</h2>
<p>من روی سرورم اوبونتو ۱۴.۰۴ نصب کردم و برای نصب nginx تنها کافی بود که دستور زیر رو وارد کنم:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">sudo </span>apt-get <span class="nb">install </span>ngingx</code></pre></figure>

<p>برای کپی کردن فایل‌ها مراحل زیر رو انجام می‌دیم:</p>

<ol>
  <li><code class="highlighter-rouge">sudo mkdir /etc/nginx/ssl</code></li>
  <li><code class="highlighter-rouge">sudo mv PATH_TO_BUNDLE_FILE /etc/nginx/ssl/</code></li>
  <li><code class="highlighter-rouge">sudo mv PATH_TO_KEY.PEM_FILE /etc/nginx/ssl/</code></li>
  <li><code class="highlighter-rouge">sudo chmod 600 /etc/nginx/ssl</code></li>
</ol>

<p>دستور آخر دسترسی به پوشه فوق رو محدود به مالک می‌کنه. چون من با کاربری غیر از روت به دستگاه وصل شدم و با کاربر روت این پوشه رو ساختم دیگر تنها روته که می‌تونه رو این پوشه بخونه و بنویسه.</p>

<h2 id="تنظیم-nginx">تنظیم nginx</h2>
<p>حالا <em>nginx</em> رو تنظیم می‌کنیم که همه ترافیک <em>http</em>‌ رو بفرسته روی <em>https</em>:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">sudo </span>vim /etc/nginx/sites-available/default</code></pre></figure>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">server <span class="o">{</span>
        listen 80 default_server<span class="p">;</span>

        server_name mehdix.org<span class="p">;</span>

        <span class="k">return   </span>301 https://<span class="nv">$server_name$request_uri</span><span class="p">;</span>
<span class="o">}</span></code></pre></figure>

<p>روی پورت ۸۰ گوش کن و هرچه درخواست برای <em>mehdix.org</em> بدستت رسید بفرست با کد ۳۰۱ روی همین سرور ولی با <em>https</em>. حالا وقت تنظیمات خود <em>https</em> رسیده:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">server <span class="o">{</span>
        listen 443<span class="p">;</span>

        server_name mehdix.org<span class="p">;</span>

        root /usr/share/nginx/html<span class="p">;</span>
        index index.html index.htm<span class="p">;</span>

        ssl on<span class="p">;</span>
        ssl_certificate /etc/nginx/ssl/bundle.cer<span class="p">;</span>
        ssl_certificate_key /etc/nginx/ssl/key.pem<span class="p">;</span>
<span class="o">}</span></code></pre></figure>

<p>و یک ریستات و والسلام:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">sudo </span>service nginx restart</code></pre></figure>

<p>و این هم رنگ خوش سبز <em>https</em> در کروم:</p>

<p><img src="assets/pimg/https.png" alt="image" /></p>


  
    <div id="related-posts">
      <h3>مطالب مرتبط</h3>
      <ul>
        
          <li><a href="/free-https-for-all.html">گواهینامه SSL/TLS مجّانی برای همه</a></li>
        
          <li><a href="/netlify.html">فعالسازی HTTPS به کمک Netlify</a></li>
        
          <li><a href="/css-list-style-type.html">لیستی با حروف ابجد</a></li>
        
          <li><a href="/rtl-feed.html">تولید خوراک اتم راست‌به‌چپ</a></li>
        
          <li><a href="/jekyll-structure.html">وبلاگ جکیل روی دامنه شخصی</a></li>
        
        </ul>
    </div>
  

  <small id="post-tags">
    
      <i class="fas fa-tag"></i>
      <a rel="tag" href="/tag/ssl.html">ssl</a>
    
      <i class="fas fa-tag"></i>
      <a rel="tag" href="/tag/%D8%A7%D9%85%D9%86%DB%8C%D8%AA.html">امنیت</a>
    
      <i class="fas fa-tag"></i>
      <a rel="tag" href="/tag/%D9%88%D8%A8.html">وب</a>
    

    <i class="fas fa-code"></i>
    
    
    <a href="https://raw.githubusercontent.com/mehdisadeghi/mehdix.ir/master/_source/_posts/2014-12-18-installing-ssl-certificate.md">سورس</a>
    
  </small>

  <nav class="pagination">
    
      <a href="https://mehdix.ir/jekyll-structure.html" class="pagination--pager" title="وبلاگ جکیل روی دامنه شخصی">قبلی</a>
    

    
      <a href="https://mehdix.ir/jekyll-jalali-plugin.html" class="pagination--pager" title="پلاگین تاریخ جلالی برای جکیل">بعدی </a>
    
  </nav>

  <section>
    
      
<section id="static-comments">
  
  
  

  <form id="comment-form" name="comment" netlify-honeypot="bot-field" netlify>
    <input name="bot-field" style="display:none">
    <input name="page_id" style="display:none" value="/installing-ssl-certificate">
    <input id="reply-to" name="reply-to" style="display:none">
    <label for="message">دیدگاه<sup class="required">*</sup> &nbsp;<small>می‌توانید با <a href="http://commonmark.org/help/" target="_">مارک‌داون</a> هم بنویسید.</small><br><small id="replyToVisualClue"></small>
      <textarea id="message" name="message" required alt="no!!" onkeyup="preview()"></textarea>
      <div id="preview"></div>
    </label>
    <label for="name">نام<sup class="required">*</sup>
      <input id="name" type="text" name="name" required>
    </label>
    <label for="email">ایمیل<sup class="required">*</sup>
      <input id="email" type="email" name="email" required>
    </label>
    <label for="website">وبسایت
      <input id="website" type="url" name="website">
    </label>
    <div style="text-align:left">
      <button type="submit" class="button">ارسال</button>
    </div>
  </form>

</section>
<script src="https://mehdix.ir/assets/js/showdown.min.js" type="text/javascript">
</script>
<script type="text/javascript">
  function preview() {
    var converter = new showdown.Converter();
    var markdown = document.getElementById("message").value;
    document.getElementById("preview").innerHTML = converter.makeHtml(markdown);
  }

  function replyTo(commentID) {
    var comment = document.getElementById(commentID);
    document.getElementById("reply-to").value = comment.querySelector("span[commentId]").innerText;
    document.getElementById("replyToVisualClue").innerText = "[در جواب " + comment.querySelector("span[commenter]").innerText + "]";
  }
</script>
    
  </section>

</article>
</div>
    </main><footer>

  <div class="wrapper">

    

    <p id="footer-description">بچه که بودیم همیشه برای بازی خونه می‌ساختیم. حالا هم نمونه‌اش رو در وب ساختم. اینجا سکوی انتشار مطالبی در مورد دانش تولید نرم‌افزار و ایده‌ها و علایق شخصی‌ام است، بویژه راه‌حل‌های مهندسی که باعث رشد و پیشرفتم شده است و می‌تواند مورد استفاده دیگران هم قرار بگیرد.
</p>

    <ul class="social-media-list">
      
      <li>
        <i class="fab fa-github"></i>
        <a href="https://github.com/mehdisadeghi">
          <span class="username social-media-text">پروژه‌ها</span>
        </a>
      </li>
      
      
      <li>
        <i class="fab fa-twitter-square"></i>
        <a href="https://twitter.com/msadeghii">
          <span class="username social-media-text">توئیت‌ها</span>
        </a>
      </li>
      
      
      <li>
        <i class="fas fa-rss"></i>
        <a href="https://feedburner.google.com/fb/a/mailverify?uri=mehdixir&amp;loc=en_US">
          <span class="username social-media-text">خبرنامه</span></a>
      </li>
      <li>
        <i class="fas fa-rss"></i>
        <a href="http://feeds.feedburner.com/mehdixir">
        <span class="username social-media-text">خوراک</span></a>
      </li>
      
      
        <li>
          <i class="fas fa-envelope-open"></i>
          <a href="mailto:sadeghi@mehdix.org">
            <span class="username social-media-text">تماس</span></a></li>
      
    </ul>

  <div id="footer-extra">
    <small id="license">
  <i class="fab fa-creative-commons"></i>
  مطالب این وبلاگ تحت مجوز
  <a rel="license" href="http://creativecommons.org/licenses/by/4.0/deed.fa">
    کریتیو کامنز اتریبیوشن ۴.۰ اینترنشنال
  </a>قرار دارد.
</small>
    <a id="atom" href="https://validator.w3.org/feed/check.cgi?url=https://mehdix.ir/feed.xml"><img src=https://mehdix.ir/assets/img/valid-atom.png alt="[Valid Atom 1.0]" title="Validate my Atom 1.0 feed" /></a>
  </div>

  </div>

  <small id="build-time">Site generated on Tue, 06 Feb 2018 02:43:37 +0100</small>

</footer><script src="https://mehdix.ir/assets/js/main.js"></script>
     <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-57282325-1', 'auto');
  ga('send', 'pageview');

</script>
 
  </body>
</html>