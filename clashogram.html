<!DOCTYPE html>
<html dir="rtl" lang="fa">
  
  <head><meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="author" content="مهدی صادقی" />
<meta name="copyright" content="Commons Attribution 4.0 International" />
<meta name="robot" content="" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="description" content="سکوی انتشار مطالبی در مورد دانش تولید نرم‌افزار و ایده‌ها و علایق شخصی‌ام." />

<link rel="canonical" href="https://mehdix.ir/publishing-with-jekyll.html" />
<link rel="icon" href="https://mehdix.ir/assets/img/me.png" />
<link rel="stylesheet" href="https://mehdix.ir/assets/css/main.css" />
<link rel="stylesheet" href="https://mehdix.ir/assets/fonts/fontawesomev5.0.2.css" />
<meta name="keywords" content='بازی,کلش,تلگرام,پروژه' /><title>کلشوگرام - مهدی صادقی</title><!-- Begin Jekyll SEO tag v2.4.0 -->
<title>کلشوگرام | مهدی صادقی</title>
<meta name="generator" content="Jekyll v3.7.2" />
<meta property="og:title" content="کلشوگرام" />
<meta name="author" content="مهدی صادقی" />
<meta property="og:locale" content="fa_IR" />
<meta name="description" content="من هر از گاهی به همراه دوستانم در کلنی که داریم کلش بازی می‌کنم. دوست داشتیم که بتوانیم بدون باز کردن بازی جزئیات وارها را دنبال بکنیم. من هم کلشوگرام را نوشتم که با استفاده از API کلش آو کلنز آخرین اخبار وار را از سرورهای سوپرسل بخواند و روی یک کانال تلگرامی (یا هرجای دیگر) ارسال کند." />
<meta property="og:description" content="من هر از گاهی به همراه دوستانم در کلنی که داریم کلش بازی می‌کنم. دوست داشتیم که بتوانیم بدون باز کردن بازی جزئیات وارها را دنبال بکنیم. من هم کلشوگرام را نوشتم که با استفاده از API کلش آو کلنز آخرین اخبار وار را از سرورهای سوپرسل بخواند و روی یک کانال تلگرامی (یا هرجای دیگر) ارسال کند." />
<link rel="canonical" href="https://mehdix.ir/clashogram.html" />
<meta property="og:url" content="https://mehdix.ir/clashogram.html" />
<meta property="og:site_name" content="مهدی صادقی" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-09-24T00:00:00+02:00" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@msadeghii" />
<meta name="twitter:creator" content="@مهدی صادقی" />
<script type="application/ld+json">
{"@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://mehdix.ir/clashogram.html"},"url":"https://mehdix.ir/clashogram.html","author":{"@type":"Person","name":"مهدی صادقی"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://mehdix.ir/assets/img/me.png"},"name":"مهدی صادقی"},"description":"من هر از گاهی به همراه دوستانم در کلنی که داریم کلش بازی می‌کنم. دوست داشتیم که بتوانیم بدون باز کردن بازی جزئیات وارها را دنبال بکنیم. من هم کلشوگرام را نوشتم که با استفاده از API کلش آو کلنز آخرین اخبار وار را از سرورهای سوپرسل بخواند و روی یک کانال تلگرامی (یا هرجای دیگر) ارسال کند.","headline":"کلشوگرام","dateModified":"2017-09-24T00:00:00+02:00","datePublished":"2017-09-24T00:00:00+02:00","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  </head>

  <body><header>
  <div class="wrapper">
    <a class="site-title" href="https://mehdix.ir/">مهدی صادقی</a>
    <small id="motto"> در مورد نرم‌افزار و ایده‌هایم </small>
  </div>
</header>
<main>
      <div class="wrapper">

<article class="post-content">

  <div class="post-header">
    <h1 class="post-title">کلشوگرام</h1>
    <p>
      <i class="fas fa-calendar"></i>
      یک‌شنبه ۰۲ مهر ۱۳۹۶<br>
      
      <i class="fas fa-stopwatch"></i>
      ۲ دقیقه مطالعه
    </p>
  </div>

  <p>من هر از گاهی به همراه دوستانم در کلنی که داریم کلش بازی می‌کنم. دوست داشتیم که بتوانیم بدون باز کردن بازی جزئیات وارها را دنبال بکنیم. من هم <a href="https://github.com/mehdisadeghi/clashogram/">کلشوگرام</a> را نوشتم که با استفاده از API کلش آو کلنز آخرین اخبار وار را از سرورهای سوپرسل بخواند و روی یک کانال تلگرامی (یا هرجای دیگر) ارسال کند.</p>

<p>هدف از بکارگیری برنامه اینست که بدون باز کردن بازی بتوان اخبار وار را دنبال کرد. خوشبختانه شرکت سوپرسل، تولید کننده بازی کلش آو کلنز، مدتی است دسترسی به بخشی از امکانات بازی را از طریق وب فراهم کرده است. یعنی می‌شود اطلاعات مختلفی را از سرورهای بازی از طریق برنامه‌نویسی دریافت کرد. یکی از این موارد وارلاگ یک کلن است، البته به شرط آنکه وارلاگ را عمومی کرده باشید. کلن ما (YVL0C8UY) وارلاگش معمولا باز است. بنابراین کافیست برنامه‌ای بنویسیم که این سرویس را به طور مرتب مانیتور کند و تغییرات را گزارش کند.</p>

<p>من برنامه‌ای با پایتون نوشتم که هر چند دقیقه سرویس وارلاگ را صدا می‌کند و اگر حمله‌ی جدیدی انجام شده باشد یک پیام از طریق تلگرام به یک کانال ارسال می‌کند. البته لازم نیست لزوما تلگرام باشد. می‌تواند پیام را به هرجای دیگری هم بفرستد.</p>

<p>نحوه بکارگیری ولی قدری زحمت دارد. اول باید مقدمات زیر را فراهم کرد:</p>

<ul>
  <li>اول باید  یک اکانت دولوپر در ‬<a href="https://developer.clashofclans.com/#/account">پورتال توسعه‌دهندگان</a> ساخت.</li>
  <li>بعد یک توکن در همان سایت بسازید.  برای اینکار باید آپی پی معتبر خودتان را <a href="http://whatismyipaddress.com">بدانید</a>.</li>
  <li>گام بعدی ساخت یک بات تلگرام به کمک <a href="https://telegram.me/BotFather">بات‌فادر</a> است.</li>
  <li>بعد باید بات تلگرامی که ساختیم را به یک گروه تلگرامی که قصد داریم پیامها را به آنجا بفرستیم به عنوان مدیر اضافه کنیم.</li>
  <li>لاگ کلن خودتان را باز کنید.</li>
  <li>تگ کلن را یادداشت کنید.</li>
</ul>

<p>توضیح کوتاهی هم در مورد موارد بالا بدهم. آی پی باید ثابت باشد چون برای ساخت توکن باید یک آی پی وارد کنید و سرور سوپرسل فقط به درخواستهایی که از آن آی‌پی بیایند جواب خواهد داد. ناگفته پیداست که اگر قصد اجرای برنامه در خانه را دارید احتمالا باید چند روز یکبار توکن را مجددا بسازید چون آی‌پی‌های خانگی معمولا متغیر هستند. علت ادمین کردن بات در کانال هم به این خاطر است که فقط باتهای ادمین قادر به ارسال پیام هستند.</p>

<p>با این توضیحات می‌توان برنامه را نصب و اجرا کرد. اگر با پایتون آشنا هستید که خیلی راحت است. باید پایتون ۳ را نصب داشته باشید:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>pip <span class="nb">install </span>clashogram
</code></pre></div></div>

<p>بعد از نصب می‌توانیم برنامه را با وارد کردن اطلاعاتی که پیشتر جمع‌آوری کرده‌ایم اجرا کنیم:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ LANGUAGE</span><span class="o">=</span>fa_IR clashogram <span class="nt">--coc-token</span> &lt;COC_TOKEN&gt; <span class="nt">--clan-tag</span> &lt;CLAN_TAG&gt; <span class="nt">--bot-token</span> &lt;TELEGRAM_BOT_TOKEN&gt; <span class="nt">--channel-name</span> &lt;TELEGRAM_CHANNEL_NAME&gt;
</code></pre></div></div>

<p>برای نمونه پیامهای <a href="https://t.me/iranclanwars">کانال کلن ایران</a> را ببینید.</p>

<p>کد برنامه را سعی کردم تمیز بنویسم و تعداد قابل توجهی هم تست ضمیمه برنامه کرده‌ام. هدفم این بود که کد خوانا و ساده باشد تا اگر کسی دوست داشت بتواند آنرا توسعه بدهد. به روال همیشه کد برنامه را در گیت‌هاب <a href="https://github.com/mehdisadeghi/clashogram/">منتشر</a> کرده‌ام.</p>



  
    <div id="related-posts">
      <h3>مطالب مرتبط</h3>
      <ul>
        
          <li><a href="/react-mathjax-preview.html">تولید فرمولهای زیبای ریاضی در وب</a></li>
        
          <li><a href="/saaghibot-released.html">انتشار ساقی‌بات</a></li>
        
        </ul>
    </div>
  

  <small id="post-tags">
    
      <i class="fas fa-tag"></i>
      <a rel="tag" href="/tag/%D8%A8%D8%A7%D8%B2%DB%8C.html">بازی</a>
    
      <i class="fas fa-tag"></i>
      <a rel="tag" href="/tag/%DA%A9%D9%84%D8%B4.html">کلش</a>
    
      <i class="fas fa-tag"></i>
      <a rel="tag" href="/tag/%D8%AA%D9%84%DA%AF%D8%B1%D8%A7%D9%85.html">تلگرام</a>
    
      <i class="fas fa-tag"></i>
      <a rel="tag" href="/tag/%D9%BE%D8%B1%D9%88%DA%98%D9%87.html">پروژه</a>
    

    <i class="fas fa-code"></i>
    
    
    <a href="https://raw.githubusercontent.com/mehdisadeghi/mehdix.ir/master/_source/_posts/2017-09-24-clashogram.markdown">سورس</a>
    
  </small>

  <nav class="pagination">
    
      <a href="https://mehdix.ir/rip-ashkan.html" class="pagination--pager" title="درگذشت اشکان قاسمی">قبلی</a>
    

    
      <a href="https://mehdix.ir/react-mathjax-preview.html" class="pagination--pager" title="تولید فرمولهای زیبای ریاضی در وب">بعدی </a>
    
  </nav>

  <section>
    
      
<section id="static-comments">
  
  
  
  <h4 id="comments-header">دیدگاه‌ها</h4>
  <div id="comments">
    
    <div class="comment-chain">
      <article id="5a4218cd45c4ff3b4b8e002d">
        <div class="comment-image-wrapper">
          <img class="comment-avatar" src="https://www.gravatar.com/avatar/94d3b90d324ae028d2b0933df7a780ac?s=200&d=robohash" />
        </div>
        <div class="comment-body-wrapper">
          <span class="comment-meta">
            <small>
              
                <span commenter>علی</span>
              
            </small>
            <small> &nbsp; <a href="#5a4218cd45c4ff3b4b8e002d">۰۵ دی ۱۳۹۶</a></small>
            <small> &nbsp; <a href="#comment-form" onclick="replyTo('5a4218cd45c4ff3b4b8e002d')">پاسخ</a></small>
            <span style="display:none" commentId>5a4218cd45c4ff3b4b8e002d</span>
          </span>
          <p>سلام
من دارم از کلشوگرام شما استفاده میکنم.
قابلیتهای خیلی خوبی داره و من بعنوان یکی ا زاعضای کلن که هم شاغل هستم و هم دوست دارم داخل بازی فعال باشم بسیار مناسبه.
یه چیز خوبی که این جریان در روند استفاده ایجاد میکنه اینه که بازی رو فقط محدود به بازی نمیکنه. شما میتونید بازی رو به تلگرام خودتون گسترش بدید و با استفاده از روابط داخل این شبکه اجتماعی به برنامه ریزی و نظارت روی وارهای داخل بازی بپردازید.
بازهم متشکرم از این برنامه کاربردی و زیبا!</p>

        </div>
      </article>

        

    </div>
    
  </div>
  

  <form id="comment-form" name="comment" netlify-honeypot="bot-field" netlify>
    <input name="bot-field" style="display:none">
    <input name="page_id" style="display:none" value="/clashogram">
    <input id="reply-to" name="reply-to" style="display:none">
    <label for="message">دیدگاه<sup class="required">*</sup> &nbsp;<small>می‌توانید با <a href="http://commonmark.org/help/" target="_">مارک‌داون</a> هم بنویسید.</small><br><small id="replyToVisualClue"></small>
      <textarea id="message" name="message" required alt="no!!" onkeyup="preview()"></textarea>
      <div id="preview"></div>
    </label>
    <label for="name">نام<sup class="required">*</sup>
      <input id="name" type="text" name="name" required>
    </label>
    <label for="email">ایمیل<sup class="required">*</sup>
      <input id="email" type="email" name="email" required>
    </label>
    <label for="website">وبسایت
      <input id="website" type="url" name="website">
    </label>
    <div style="text-align:left">
      <button type="submit" class="button">ارسال</button>
    </div>
  </form>

</section>
<script src="https://mehdix.ir/assets/js/showdown.min.js" type="text/javascript">
</script>
<script type="text/javascript">
  function preview() {
    var converter = new showdown.Converter();
    var markdown = document.getElementById("message").value;
    document.getElementById("preview").innerHTML = converter.makeHtml(markdown);
  }

  function replyTo(commentID) {
    var comment = document.getElementById(commentID);
    document.getElementById("reply-to").value = comment.querySelector("span[commentId]").innerText;
    document.getElementById("replyToVisualClue").innerText = "[در جواب " + comment.querySelector("span[commenter]").innerText + "]";
  }
</script>
    
  </section>

</article>
</div>
    </main><footer>

  <div class="wrapper">

    

    <p id="footer-description">بچه که بودیم همیشه برای بازی خونه می‌ساختیم. حالا هم نمونه‌اش رو در وب ساختم. اینجا سکوی انتشار مطالبی در مورد دانش تولید نرم‌افزار و ایده‌ها و علایق شخصی‌ام است، بویژه راه‌حل‌های مهندسی که باعث رشد و پیشرفتم شده است و می‌تواند مورد استفاده دیگران هم قرار بگیرد.
</p>

    <ul class="social-media-list">
      
      <li>
        <i class="fab fa-github"></i>
        <a href="https://github.com/mehdisadeghi">
          <span class="username social-media-text">پروژه‌ها</span>
        </a>
      </li>
      
      
      <li>
        <i class="fab fa-twitter-square"></i>
        <a href="https://twitter.com/msadeghii">
          <span class="username social-media-text">توئیت‌ها</span>
        </a>
      </li>
      
      
      <li>
        <i class="fas fa-rss"></i>
        <a href="https://feedburner.google.com/fb/a/mailverify?uri=mehdixir&amp;loc=en_US">
          <span class="username social-media-text">خبرنامه</span></a>
      </li>
      <li>
        <i class="fas fa-rss"></i>
        <a href="http://feeds.feedburner.com/mehdixir">
        <span class="username social-media-text">خوراک</span></a>
      </li>
      
      
        <li>
          <i class="fas fa-envelope-open"></i>
          <a href="mailto:sadeghi@mehdix.org">
            <span class="username social-media-text">تماس</span></a></li>
      
    </ul>

  <div id="footer-extra">
    <small id="license">
  <i class="fab fa-creative-commons"></i>
  مطالب این وبلاگ تحت مجوز
  <a rel="license" href="http://creativecommons.org/licenses/by/4.0/deed.fa">
    کریتیو کامنز اتریبیوشن ۴.۰ اینترنشنال
  </a>قرار دارد.
</small>
    <a id="atom" href="https://validator.w3.org/feed/check.cgi?url=https://mehdix.ir/feed.xml"><img src=https://mehdix.ir/assets/img/valid-atom.png alt="[Valid Atom 1.0]" title="Validate my Atom 1.0 feed" /></a>
  </div>

  </div>

  <small id="build-time">Site generated on Tue, 06 Feb 2018 02:43:37 +0100</small>

</footer><script src="https://mehdix.ir/assets/js/main.js"></script>
     <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-57282325-1', 'auto');
  ga('send', 'pageview');

</script>
 
  </body>
</html>