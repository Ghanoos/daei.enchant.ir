<!DOCTYPE html>
<html dir="rtl" lang="fa">
  
  <head><meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="author" content="مهدی صادقی" />
<meta name="copyright" content="Commons Attribution 4.0 International" />
<meta name="robot" content="" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="description" content="سکوی انتشار مطالبی در مورد دانش تولید نرم‌افزار و ایده‌ها و علایق شخصی‌ام." />

<link rel="canonical" href="https://mehdix.ir/publishing-with-jekyll.html" />
<link rel="icon" href="https://mehdix.ir/assets/img/me.png" />
<link rel="stylesheet" href="https://mehdix.ir/assets/css/main.css" />
<link rel="stylesheet" href="https://mehdix.ir/assets/fonts/fontawesomev5.0.2.css" />
<meta name="keywords" content='atom,خوراک,rss,rtl,وب' /><title>تولید خوراک اتم راست‌به‌چپ - مهدی صادقی</title><!-- Begin Jekyll SEO tag v2.4.0 -->
<title>تولید خوراک اتم راست‌به‌چپ | مهدی صادقی</title>
<meta name="generator" content="Jekyll v3.7.2" />
<meta property="og:title" content="تولید خوراک اتم راست‌به‌چپ" />
<meta name="author" content="مهدی صادقی" />
<meta property="og:locale" content="fa_IR" />
<meta name="description" content="نمایش راست به چپ خوراک بسیاری از وبسایت‌های فارسی در خبرخوان‌ها درست نیست. بنابراین تصمیم گرفتم این مساله را بررسی کنم و حداقل از نمایش صحیح مطالب وبسایت خودم در خبرخوان‌ها اطمینان حاصل کنم." />
<meta property="og:description" content="نمایش راست به چپ خوراک بسیاری از وبسایت‌های فارسی در خبرخوان‌ها درست نیست. بنابراین تصمیم گرفتم این مساله را بررسی کنم و حداقل از نمایش صحیح مطالب وبسایت خودم در خبرخوان‌ها اطمینان حاصل کنم." />
<link rel="canonical" href="https://mehdix.ir/rtl-feed.html" />
<meta property="og:url" content="https://mehdix.ir/rtl-feed.html" />
<meta property="og:site_name" content="مهدی صادقی" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2015-05-31T00:00:00+02:00" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@msadeghii" />
<meta name="twitter:creator" content="@مهدی صادقی" />
<script type="application/ld+json">
{"@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://mehdix.ir/rtl-feed.html"},"url":"https://mehdix.ir/rtl-feed.html","author":{"@type":"Person","name":"مهدی صادقی"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://mehdix.ir/assets/img/me.png"},"name":"مهدی صادقی"},"description":"نمایش راست به چپ خوراک بسیاری از وبسایت‌های فارسی در خبرخوان‌ها درست نیست. بنابراین تصمیم گرفتم این مساله را بررسی کنم و حداقل از نمایش صحیح مطالب وبسایت خودم در خبرخوان‌ها اطمینان حاصل کنم.","headline":"تولید خوراک اتم راست‌به‌چپ","dateModified":"2015-05-31T00:00:00+02:00","datePublished":"2015-05-31T00:00:00+02:00","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  </head>

  <body><header>
  <div class="wrapper">
    <a class="site-title" href="https://mehdix.ir/">مهدی صادقی</a>
    <small id="motto"> در مورد نرم‌افزار و ایده‌هایم </small>
  </div>
</header>
<main>
      <div class="wrapper">

<article class="post-content">

  <div class="post-header">
    <h1 class="post-title">تولید خوراک اتم راست‌به‌چپ</h1>
    <p>
      <i class="fas fa-calendar"></i>
      یک‌شنبه ۱۰ خرداد ۱۳۹۴<br>
      
      <i class="fas fa-stopwatch"></i>
      ۳ دقیقه مطالعه
    </p>
  </div>

  <p>نمایش راست به چپ خوراک بسیاری از وبسایت‌های فارسی در خبرخوان‌ها درست نیست. بنابراین تصمیم گرفتم این مساله را بررسی کنم و حداقل از نمایش صحیح مطالب وبسایت خودم در خبرخوان‌ها اطمینان حاصل کنم.</p>

<p>من برای مطالعه منابع مختلف اینترنتی از خبرخوان‌<sup id="fnref:1"><a href="#fn:1" class="footnote">1</a></sup> استفاده می‌کنم. <a href="https://digg.com/reader">خبرخوان محبوب من</a> یک بدیل<sup id="fnref:2"><a href="#fn:2" class="footnote">2</a></sup> از گوگل‌ریدر مرحوم است که بخشی از سایت دیگ حساب می‌شود. من به طور معمول خوراک‌ها را به دیگ اضافه می‌کنم و همانجا هم می‌خوانم. مشکل اینجاست که درستی نمایش متن در وبسایت اصلی هیچ ربطی به نمایش در خوراک‌خوان ندارد. علت اینجاست که خوراک‌خوان متنی که معمولا توسط فایلی به feed.xml یا توسط feedburnder تولید می‌شود را دانلود و پردازش می‌کند و سعی می‌کند آن را به نحو صحیح نمایش بدهد.</p>

<p>از جایی که مطالب من نیز در دیگ چپ به راست نمایش داده می‌شد اول به سراغ تعریفی<sup id="fnref:3"><a href="#fn:3" class="footnote">3</a></sup> رفتم که خوراک سایتم مطابق آن تولید می‌شود. در وب دو استاندارد بسیار آشنا برای خروجی خوراک‌ها وجود دارد. اولی <sup id="fnref:4"><a href="#fn:4" class="footnote">4</a></sup>RSS 2.0 و دیگری <sup id="fnref:5"><a href="#fn:5" class="footnote">5</a></sup>Atom 1.0 است. این دو تقریبا همه خوراک‌های موجود در وب را شامل می‌شوند. با جستجویی در تعریف آنها به این نتیجه رسیدم که امکان مشخص کردن جهت متن در تعریف آنها تعبیه نشده است (تا جایی که من جستجو کردم). بنابراین به دنبال راه حل دیگری برآمدم. با تغییر تگی که شامل محتوای هر پست است سعی کردم محتوای هر پست را در یک تگ html با استایل راست به چپ محصور کنم.</p>

<figure class="center border">
  <figcaption>
نمایش نادرست نوشتار راست به چپ
</figcaption>
  <p><img src="assets/pimg/rtl-feed/before.png" alt="image not found" title="نمایش خوراک پیش از اعمال تغییرات" /></p>
</figure>

<p>تصویر بالا نشان می‌دهد که من در سایت دیگ چطور بیشتر مطالب فارسی را می‌بینم. من قالبی که مسئول تولید خوراک وبسایتم است به شیوه زیر تغییر دادم تا هم با فرمت Atom 1.0 سازگار شود و هم محتوای هر پست در یک تگ <code class="highlighter-rouge">div</code> محصور شود. در ضمن من می‌خواهم که یک خوراک معتبر داشته باشم که بدون مشکل در فید‌خوان‌های مختلف به نمایش دربیاید.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
---
---
<span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;feed</span> <span class="na">xmlns=</span><span class="s">"http://www.w3.org/2005/Atom"</span><span class="nt">&gt;</span>
<span class="nt">&lt;title</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">xml:lang=</span><span class="s">"fa"</span><span class="nt">&gt;</span>{{ site.title }}<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"alternate"</span> <span class="na">type=</span><span class="s">"text/html"</span> <span class="na">href=</span><span class="s">"{{ site.url }}"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"self"</span> <span class="na">type=</span><span class="s">"application/atom+xml"</span> <span class="na">href=</span><span class="s">"{{ site.url }}/feed/"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;updated&gt;</span>{{ site.time | date: "%Y-%m-%dT%H:%M:%SZ" }}<span class="nt">&lt;/updated&gt;</span>
<span class="nt">&lt;id&gt;</span>urn:uuid:1e7d9dd8-29e4-475d-adc5-17494fb80445<span class="nt">&lt;/id&gt;</span>
<span class="nt">&lt;author&gt;</span>
	<span class="nt">&lt;name&gt;</span>{{ site.author }}<span class="nt">&lt;/name&gt;</span>
	<span class="nt">&lt;uri&gt;</span>{{ site.url }}<span class="nt">&lt;/uri&gt;</span>
	<span class="nt">&lt;email&gt;</span>{{ site.email }}<span class="nt">&lt;/email&gt;</span>
<span class="nt">&lt;/author&gt;</span>
<span class="nt">&lt;rights&gt;</span>{{ site.copyright }}<span class="nt">&lt;/rights&gt;</span>
{% for post in site.posts limit: 8 %}
	<span class="nt">&lt;entry&gt;</span>
		<span class="nt">&lt;title&gt;</span>{{ post.title }}<span class="nt">&lt;/title&gt;</span>
		<span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"alternate"</span> <span class="na">type=</span><span class="s">"text/html"</span> <span class="na">href=</span><span class="s">"{{ site.url }}{{ post.url }}"</span><span class="nt">/&gt;</span>
		<span class="nt">&lt;id&gt;</span>urn:uuid:{{ post.uuid }}<span class="nt">&lt;/id&gt;</span>
		<span class="nt">&lt;updated&gt;</span>{{ post.date | date: "%Y-%m-%dT%H:%M:%SZ" }}<span class="nt">&lt;/updated&gt;</span>
		{% for tag in post.tags %}<span class="nt">&lt;category</span> <span class="na">term=</span><span class="s">"{{ tag }}"</span><span class="nt">/&gt;</span>{% endfor %}
			<span class="nt">&lt;content</span> <span class="na">type=</span><span class="s">"html"</span><span class="nt">&gt;</span>
				<span class="cp">&lt;![CDATA[&lt;div dir="rtl"&gt;{{ post.content }}&lt;/div&gt;]]&gt;</span>
			<span class="nt">&lt;/content&gt;</span>
	<span class="nt">&lt;/entry&gt;</span>
{% endfor %}
<span class="nt">&lt;/feed&gt;</span>

</code></pre></div></div>

<h2 id="اتم-یا-rss">اتم یا RSS؟</h2>
<p>کدی که در بالا آمده مطابق با استاندارد اتم ۱.۰ است. پیش از این از RSS استفاده می‌کردم ولی متوجه شدم که فرمتی بسیار مبهم است و طراحی خوبی ندارد (مقاله خوبی در شرح این اشکالات و مقایسه اتم و RSS به زبان انگلیسی <a href="http://nullprogram.com/blog/2013/09/23/">در این سایت</a> وجود دارد). برای پشتبانی از اتم مجبور بودم به تمام مطالب قبلی وبسایت نیز یک uuid اختصاص بدهم و از این پس هم برای هر مطلب جدید اینکار را انجام بدهم، چرا که طبق اتم هر مطلب باید یک آی‌دی منحصر به فرد داشته باشد تا برای خوراک‌خوان‌ها تشخیص مطالب تکراری و یکتا امکانپذیر باشد.</p>

<p>بهرحال با تغییر ساده‌ای که در بالا آمده اکنون خوراک وبسایت به درستی در خوراک‌خوان (الااقل دیگ) به نمایش درمی‌آید! در تصویر زیر این امر پیداست. هرچند عنوان مطلب همچنان در سمت چپ نمایش داده می‌شود که برای آن کاری از دستم ساخته نیست. البته خرده‌کاری‌هایی هم باقی مانده است. مثلا در حال حاضر کدهای داخل متن راست چین نمایش داده می‌شود که باید با اصلاح استایل‌ خوراک آن‌ها را درست کنم، اما باشد برای فرصتی دیگر.</p>

<figure class="center border">
  <figcaption>
نمایش ‫‫بهتر متن راست به چپ پس از اعمال تغییرات
</figcaption>
  <p><img src="assets/pimg/rtl-feed/after.png" alt="image not found" title="نمایش خوراک پیش از اعمال تغییرات" /></p>
</figure>

<p>حسن ختام این پست نیز لینک به صفحه اعتبارسنجی خوراک وبسایت است!</p>

<p class="center"><a href="http://validator.w3.org/feed/check.cgi?url=http%3A//mehdix.ir/feed.xml"><img src="assets/pimg/rtl-feed/valid-atom.png" alt="[Valid Atom 1.0]" title="Validate my Atom 1.0 feed" /></a></p>

<div class="footnotes">
  <ol>
    <li id="fn:1">
      <p>Feed reader <a href="#fnref:1" class="reversefootnote">&#8617;</a></p>
    </li>
    <li id="fn:2">
      <p>Replica <a href="#fnref:2" class="reversefootnote">&#8617;</a></p>
    </li>
    <li id="fn:3">
      <p>Specifications <a href="#fnref:3" class="reversefootnote">&#8617;</a></p>
    </li>
    <li id="fn:4">
      <p>https://www.ietf.org/rfc/rfc4287.txt <a href="#fnref:4" class="reversefootnote">&#8617;</a></p>
    </li>
    <li id="fn:5">
      <p>http://cyber.law.harvard.edu/rss/rss.html <a href="#fnref:5" class="reversefootnote">&#8617;</a></p>
    </li>
  </ol>
</div>


  
    <div id="related-posts">
      <h3>مطالب مرتبط</h3>
      <ul>
        
          <li><a href="/pygtk-rtl-bug.html">چالش جدید، تعمیر pygtk</a></li>
        
          <li><a href="/github-rtl.html">راست به چپ نویسی در گیتهاب</a></li>
        
          <li><a href="/evolution-composer-rtl.html">ماژول راست به چپ اوولوشن</a></li>
        
          <li><a href="/free-https-for-all.html">گواهینامه SSL/TLS مجّانی برای همه</a></li>
        
          <li><a href="/css-list-style-type.html">لیستی با حروف ابجد</a></li>
        
        </ul>
    </div>
  

  <small id="post-tags">
    
      <i class="fas fa-tag"></i>
      <a rel="tag" href="/tag/atom.html">atom</a>
    
      <i class="fas fa-tag"></i>
      <a rel="tag" href="/tag/%D8%AE%D9%88%D8%B1%D8%A7%DA%A9.html">خوراک</a>
    
      <i class="fas fa-tag"></i>
      <a rel="tag" href="/tag/rss.html">rss</a>
    
      <i class="fas fa-tag"></i>
      <a rel="tag" href="/tag/rtl.html">rtl</a>
    
      <i class="fas fa-tag"></i>
      <a rel="tag" href="/tag/%D9%88%D8%A8.html">وب</a>
    

    <i class="fas fa-code"></i>
    
    
    <a href="https://raw.githubusercontent.com/mehdisadeghi/mehdix.ir/master/_source/_posts/2015-05-31-rtl-feed.md">سورس</a>
    
  </small>

  <nav class="pagination">
    
      <a href="https://mehdix.ir/numbers.html" class="pagination--pager" title="در ستایش اعداد">قبلی</a>
    

    
      <a href="https://mehdix.ir/suse.html" class="pagination--pager" title="سوزه یا زوزه">بعدی </a>
    
  </nav>

  <section>
    
      
<section id="static-comments">
  
  
  
  <h4 id="comments-header">دیدگاه‌ها</h4>
  <div id="comments">
    
    <div class="comment-chain">
      <article id="2055023838">
        <div class="comment-image-wrapper">
          <img class="comment-avatar" src="https://www.gravatar.com/avatar/945c978aacd4bbae57a326b5d61bb455?s=200&d=robohash" />
        </div>
        <div class="comment-body-wrapper">
          <span class="comment-meta">
            <small>
              
                <a href=https://disqus.com/by/disqus_t8zYptZ39f/ target="_"><span commenter>Bob</span></a>
              
            </small>
            <small> &nbsp; <a href="#2055023838">۱۰ خرداد ۱۳۹۴</a></small>
            <small> &nbsp; <a href="#comment-form" onclick="replyTo('2055023838')">پاسخ</a></small>
            <span style="display:none" commentId>2055023838</span>
          </span>
          <p>فيدخوان https://www.inoreader.com قابليت تشخيص راست به چپ بودن متن رو به صورت خودكار داره.</p>

        </div>
      </article>

        

    </div>
    
  </div>
  

  <form id="comment-form" name="comment" netlify-honeypot="bot-field" netlify>
    <input name="bot-field" style="display:none">
    <input name="page_id" style="display:none" value="/rtl-feed">
    <input id="reply-to" name="reply-to" style="display:none">
    <label for="message">دیدگاه<sup class="required">*</sup> &nbsp;<small>می‌توانید با <a href="http://commonmark.org/help/" target="_">مارک‌داون</a> هم بنویسید.</small><br><small id="replyToVisualClue"></small>
      <textarea id="message" name="message" required alt="no!!" onkeyup="preview()"></textarea>
      <div id="preview"></div>
    </label>
    <label for="name">نام<sup class="required">*</sup>
      <input id="name" type="text" name="name" required>
    </label>
    <label for="email">ایمیل<sup class="required">*</sup>
      <input id="email" type="email" name="email" required>
    </label>
    <label for="website">وبسایت
      <input id="website" type="url" name="website">
    </label>
    <div style="text-align:left">
      <button type="submit" class="button">ارسال</button>
    </div>
  </form>

</section>
<script src="https://mehdix.ir/assets/js/showdown.min.js" type="text/javascript">
</script>
<script type="text/javascript">
  function preview() {
    var converter = new showdown.Converter();
    var markdown = document.getElementById("message").value;
    document.getElementById("preview").innerHTML = converter.makeHtml(markdown);
  }

  function replyTo(commentID) {
    var comment = document.getElementById(commentID);
    document.getElementById("reply-to").value = comment.querySelector("span[commentId]").innerText;
    document.getElementById("replyToVisualClue").innerText = "[در جواب " + comment.querySelector("span[commenter]").innerText + "]";
  }
</script>
    
  </section>

</article>
</div>
    </main><footer>

  <div class="wrapper">

    

    <p id="footer-description">بچه که بودیم همیشه برای بازی خونه می‌ساختیم. حالا هم نمونه‌اش رو در وب ساختم. اینجا سکوی انتشار مطالبی در مورد دانش تولید نرم‌افزار و ایده‌ها و علایق شخصی‌ام است، بویژه راه‌حل‌های مهندسی که باعث رشد و پیشرفتم شده است و می‌تواند مورد استفاده دیگران هم قرار بگیرد.
</p>

    <ul class="social-media-list">
      
      <li>
        <i class="fab fa-github"></i>
        <a href="https://github.com/mehdisadeghi">
          <span class="username social-media-text">پروژه‌ها</span>
        </a>
      </li>
      
      
      <li>
        <i class="fab fa-twitter-square"></i>
        <a href="https://twitter.com/msadeghii">
          <span class="username social-media-text">توئیت‌ها</span>
        </a>
      </li>
      
      
      <li>
        <i class="fas fa-rss"></i>
        <a href="https://feedburner.google.com/fb/a/mailverify?uri=mehdixir&amp;loc=en_US">
          <span class="username social-media-text">خبرنامه</span></a>
      </li>
      <li>
        <i class="fas fa-rss"></i>
        <a href="http://feeds.feedburner.com/mehdixir">
        <span class="username social-media-text">خوراک</span></a>
      </li>
      
      
        <li>
          <i class="fas fa-envelope-open"></i>
          <a href="mailto:sadeghi@mehdix.org">
            <span class="username social-media-text">تماس</span></a></li>
      
    </ul>

  <div id="footer-extra">
    <small id="license">
  <i class="fab fa-creative-commons"></i>
  مطالب این وبلاگ تحت مجوز
  <a rel="license" href="http://creativecommons.org/licenses/by/4.0/deed.fa">
    کریتیو کامنز اتریبیوشن ۴.۰ اینترنشنال
  </a>قرار دارد.
</small>
    <a id="atom" href="https://validator.w3.org/feed/check.cgi?url=https://mehdix.ir/feed.xml"><img src=https://mehdix.ir/assets/img/valid-atom.png alt="[Valid Atom 1.0]" title="Validate my Atom 1.0 feed" /></a>
  </div>

  </div>

  <small id="build-time">Site generated on Tue, 06 Feb 2018 02:43:37 +0100</small>

</footer><script src="https://mehdix.ir/assets/js/main.js"></script>
     <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-57282325-1', 'auto');
  ga('send', 'pageview');

</script>
 
  </body>
</html>